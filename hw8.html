<!doctype html>
<html>
<head>
	<title>REST COUNTRIES API GET</title>
	<meta charset="utf-8"/>
	<script>
		function getCountry() {
			/* Step 1: Make instance of request object...
			...to make HTTP request after page is loaded*/
			request = new XMLHttpRequest();
			console.log("1 - request object created");
 
			// Step 2: Set the URL for the AJAX request to be the JSON file
 
		request.open("GET", "https://restcountries.com/v3.1/alpha/pe", true)

			console.log("2 - opened request file");
 
			// Step 3: set up event handler/callback

			request.onreadystatechange = function() {
				console.log("3 - readystatechange event fired.");
 
				if (request.readyState == 4 && request.status == 200) {

					// Step 5: wait for done + success
					console.log("5 - response received");
					result = request.responseText;
					country = JSON.parse(result);
					country = country[0].name.official;
                    document.write("Using Get Request:" + "<br />" + "<br />" + "The official name for Peru is: " + country);
                    // document.write("<br />" + "<br />" + "Total JSON Output: " + "<br />" + "<br />" + result)
					
				}
				else if (request.readyState == 4 && request.status != 200) {

					document.getElementById("country").innerHTML = "Something is wrong!  Check the logs to see where this went off the rails";

				}

				else if (request.readyState == 3) {

					document.getElementById("country").innerHTML = "Too soon!  Try again";

				}

			}
		// Step 4: fire off the HTTP request
			request.send();
			console.log("4 - Request sent");
		}
	</script>
    <script>
        res = fetch("https://restcountries.com/v3.1/alpha/pe")
        .then (res => res.text())
        .then (data => 
        {
            data = JSON.parse(data)
            data = data[0].name.official;
            document.write("<br />" + "<br />" + "Using fetch:" + "<br />" + "<br />" + "The official name for Peru is '" + data + "'")

            document.write("<br />" + "<br />" + "<br />" + "Answers to Questions:" + "<br />" + "<br />" + "1. The API I used is called REST Countries, and the point is to give the user detailed information about different countries.")
            document.write("<br />" + "<br />")
            var a = document.createElement('a');
            var linkText = document.createTextNode("Website I Used");
            a.appendChild(linkText);
            document.write("2. ")
            a.title = "Website I used";
            a.href = "https://restcountries.com/#api-endpoints-v3-code";
            document.body.appendChild(a);
            document.write("<br />" + "<br />" + "3. The two options I used for the API request were 'get' and 'fetch.' The 'get' method creates a request object with a JSON file being the target of the request, and processes information asynchronously. The 'fetch' method is a javascript API that manipulates requests and responses.")
            document.write("<br />" + "<br />" + "4. This API could be useful if (a) you want to quickly grab information about a country, or (b) you want to gather information about a country in their national language.")
            
        })
        .catch (error => console.log(error))
    </script>
    
</head>


<body onload="getCountry()">
    <h1>Peru</h1>
	<div id="country">Loading...</div>

    <script>
        var a = document.createElement('a');
        var linkText = document.createTextNode("my title text");
        a.appendChild(linkText);
        a.title = "my title text";
        a.href = "http://example.com";
        document.body.appendChild(a);
    </script>
    
</body>
</html>
